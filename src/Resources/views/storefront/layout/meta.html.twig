{% sw_extends '@@Storefront/storefront/layout/meta.html.twig' %}

{% block layout_head_javascript_feature %}
    {{ parent() }}
    {% if page.extensions.smartsuppConfiguration.key %}
        <script id="smartsupp_live_chat" key="{{ page.extensions.smartsuppConfiguration.key }}">
            function getCookie(name) {
                var cookieMatch = document.cookie.match(name + '=(.*?)(;|$)');
                return cookieMatch && decodeURI(cookieMatch[1]);
            }

            var ssCookieSet = getCookie('ssupp.consent');
                
            if (ssCookieSet != null) {
                var _smartsupp = _smartsupp || {};
                _smartsupp.key = '{{ page.extensions.smartsuppConfiguration.key }}';

                window.smartsupp||(function(d) {
                    var s,c,o=smartsupp=function(){ o._.push(arguments)};o._=[];
                    s=d.getElementsByTagName('script')[0];c=d.createElement('script');
                    c.type='text/javascript';c.charset='utf-8';c.async=true;
                    c.src='//www.smartsuppchat.com/loader.js?';s.parentNode.insertBefore(c,s);
                })(document);
            };
        </script>
    {% endif %}
{% endblock %}
